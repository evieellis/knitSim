<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lecture Feed — Inline Embedded Videos</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#f7fafc;
    --card:#ffffff;
    --muted:#6b7280;
    --accent:#111827;
  }

  body{
    margin:0;
    padding:2rem;
    font-family:Inter,system-ui,Arial,sans-serif;
    background:var(--bg);
    color:var(--accent);
    display:flex;
    justify-content:center;
  }

  .page {
    width:100%;
    max-width:960px;
  }

  h1 {
    text-align:center;
    margin:0 0 1.5rem 0;
    font-weight:600;
  }

  #videos {
    display:flex;
    flex-direction:column;
    gap:1.5rem;
  }

  .video-card{
    background:var(--card);
    border-radius:12px;
    box-shadow:0 2px 8px rgba(2,6,23,0.06);
    overflow:hidden;
    padding:0;
  }

  .meta {
    padding:0.9rem 1rem;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:1rem;
  }

  .meta .left {
    flex:1 1 auto;
  }

  .meta h2{
    margin:0;
    font-size:1rem;
    font-weight:600;
  }

  .meta p {
    margin:6px 0 0 0;
    color:var(--muted);
    font-size:0.9rem;
    line-height:1.2;
    max-height:2.4em;
    overflow:hidden;
    text-overflow:ellipsis;
  }

  .controls {
    display:flex;
    gap:0.5rem;
    align-items:center;
  }

  .btn {
    background:transparent;
    border:1px solid #e5e7eb;
    padding:6px 10px;
    border-radius:8px;
    cursor:pointer;
    font-weight:600;
    font-size:0.9rem;
  }
  .btn:hover { box-shadow:0 4px 10px rgba(2,6,23,0.06); }

  /* Embedded player */
  .player-wrap {
    width:100%;
    background:black;
    position:relative;
  }

  .player-wrap iframe{
    width:100%;
    height:520px;
    border:0;
    display:block;
  }

  @media (max-width:700px){
    .player-wrap iframe{ height:260px; }
  }

  /* Expanded overlay */
  .overlay {
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.85);
    z-index:2000;
    align-items:center;
    justify-content:center;
    padding:1rem;
  }

  .overlay.active { display:flex; }

  .overlay .overlay-inner {
    width:100%;
    max-width:1200px;
    border-radius:10px;
    overflow:hidden;
    background:#000;
    position:relative;
  }

  .overlay iframe{
    width:100%;
    height:70vh;
    border:0;
    display:block;
  }

  .overlay .close {
    position:absolute;
    right:10px;
    top:10px;
    background:rgba(255,255,255,0.08);
    color:#fff;
    border:0;
    font-size:1.1rem;
    padding:6px 10px;
    border-radius:8px;
    cursor:pointer;
  }

  footer { text-align:center; color:var(--muted); margin-top:2rem; font-size:0.9rem; }
</style>
</head>
<body>
  <div class="page">
    <h1>Lecture Feed</h1>

    <div id="videos">Loading lectures…</div>

    <footer>© 2025 Your Organization Name</footer>
  </div>

  <!-- Overlay used for "Make bigger" -->
  <div id="overlay" class="overlay" aria-hidden="true">
    <div class="overlay-inner" role="dialog" aria-modal="true">
      <button id="overlayClose" class="close" title="Close">✕</button>
      <iframe id="overlayPlayer" src="" allowfullscreen allow="autoplay; fullscreen"></iframe>
    </div>
  </div>

<script>
/*
  Inline Embedded Lecture Feed
  - Each item includes a directly embedded iframe (YouTube embed).
  - "Make bigger" uses an overlay with the same video src (native fullscreen still works).
  - Replace PLAYLIST_ID and API_KEY below.
*/

const PLAYLIST_ID = 'PLPyL9WUlsosnF2LGko0TpR4epFFuc7Om2'; // e.g. 'PL8dPuuaLjXtNlUrzyH5r6jN9ulIgZBpdo'
const API_KEY = 'AIzaSyDgmRl9Thw11FsJ5tnEbf6ztdGDFEq3HT0'; // YouTube Data API v3 key

// DOM
const videosContainer = document.getElementById('videos');
const overlay = document.getElementById('overlay');
const overlayPlayer = document.getElementById('overlayPlayer');
const overlayClose = document.getElementById('overlayClose');

overlayClose.addEventListener('click', closeOverlay);
overlay.addEventListener('click', (e) => { if (e.target === overlay) closeOverlay(); });

function openOverlay(videoId) {
  // Stop any playback inside page players by resetting their src attribute if needed
  overlayPlayer.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0`;
  overlay.classList.add('active');
  overlay.setAttribute('aria-hidden', 'false');
  // scroll into view (optional)
}

function closeOverlay() {
  overlay.classList.remove('active');
  overlay.setAttribute('aria-hidden', 'true');
  overlayPlayer.src = '';
}

// Fetch playlist items (maxResults=50). For >50 you'd need to page with nextPageToken.
async function loadPlaylist() {
  videosContainer.textContent = 'Loading lectures…';

  try {
    const resp = await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet,contentDetails&maxResults=50&playlistId=${PLAYLIST_ID}&key=${API_KEY}`);
    const data = await resp.json();

    if (!data.items || data.items.length === 0) {
      videosContainer.textContent = 'No videos found in this playlist.';
      return;
    }

    videosContainer.innerHTML = ''; // clear

    data.items.forEach(item => {
      const snippet = item.snippet || {};
      const vid = (snippet.resourceId && snippet.resourceId.videoId) || (item.contentDetails && item.contentDetails.videoId);
      if (!vid) return;

      const title = snippet.title || 'Untitled';
      const desc = snippet.description || '';
      // Use "privacy" aware thumbnail fallbacks: high -> medium -> default
      const thumb = (snippet.thumbnails && (snippet.thumbnails.high || snippet.thumbnails.medium || snippet.thumbnails.default)) || null;
      const thumbUrl = thumb ? thumb.url : '';

      // create card
      const card = document.createElement('article');
      card.className = 'video-card';
      card.innerHTML = `
        <div class="player-wrap" data-video-id="${vid}">
          <!-- Directly embedded iframe (visible inline) -->
          <iframe
            src="https://www.youtube.com/embed/${vid}?rel=0"
            allow="autoplay; fullscreen"
            title="${escapeHtml(title)}"
            loading="lazy"
          ></iframe>
        </div>

        <div class="meta">
          <div class="left">
            <h2>${escapeHtml(title)}</h2>
            <p>${escapeHtml(desc.split('\\n')[0] || '')}</p>
          </div>

          <div class="controls">
            <button class="btn play-inline" data-vid="${vid}" title="Play/Pause inline">Play / Pause</button>
            <button class="btn expand" data-vid="${vid}" title="Make bigger">Make bigger</button>
          </div>
        </div>
      `;

      // attach inline play/pause control (works by messaging the iframe using postMessage Player API)
      const playBtn = card.querySelector('.play-inline');
      const iframe = card.querySelector('iframe');

      // small helper using YouTube IFrame API postMessage commands (play/pause)
      // Note: using postMessage with 'player' API works if the embed has enablejsapi=1.
      // We didn't include enablejsapi above because the embedded iframe can be controlled by native controls.
      // For play/pause control via button we will toggle by reloading src with autoplay param as a fallback.
      let playing = true; // since iframe loads with video ready (but not autoplaying)
      playBtn.addEventListener('click', () => {
        // Toggle by toggling autoplay via src hack (simple and reliable cross-origin)
        if (!playing) {
          // start playback by re-setting src with autoplay=1
          iframe.src = `https://www.youtube.com/embed/${vid}?rel=0&autoplay=1`;
          playing = true;
          playBtn.textContent = 'Pause';
        } else {
          // pause by replacing with same src but without autoplay; this will stop playback
          // Note: this reloads the iframe (lightweight enough for lectures).
          iframe.src = `https://www.youtube.com/embed/${vid}?rel=0`;
          playing = false;
          playBtn.textContent = 'Play';
        }
      });

      // Expand button opens overlay with the same video and starts autoplay
      const expandBtn = card.querySelector('.expand');
      expandBtn.addEventListener('click', () => openOverlay(vid));

      videosContainer.appendChild(card);
    });

  } catch (err) {
    console.error(err);
    videosContainer.textContent = 'Error loading playlist — check API key and playlist ID.';
  }
}

// simple html escape to avoid injection in titles/descriptions
function escapeHtml(str = '') {
  return String(str)
    .replaceAll('&','&amp;')
    .replaceAll('<','&lt;')
    .replaceAll('>','&gt;')
    .replaceAll('"','&quot;')
    .replaceAll("'",'&#39;');
}

loadPlaylist();
</script>
</body>
</html>